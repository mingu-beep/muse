<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="en">
<head th:replace="~{/fragment/head :: head('Profile')}"></head>
<body>
<!-- HEADER -->
<div th:replace="~{/fragment/header :: header}"></div>
<!-- MAIN -->
<main>
    <section class="py-5 text-center container profile">
        <div class="row justify-content-md-center p-2">
            <div class="col">
                <svg th:if="${dto.profileImage == null}"
                        class="bd-placeholder-img rounded-circle"
                     width="180" height="180"
                     xmlns="http://www.w3.org/2000/svg"
                     role="img" aria-label="Placeholder" preserveAspectRatio="xMidYMid slice" focusable="false">
                    <title>Placeholder</title><rect width="100%" height="100%" fill="var(--bs-secondary-color)"></rect></svg>
                <img th:unless="${dto.profileImage == null}"
                     class="bd-placeholder-img rounded-circle"
                     width="180" height="180"
                     th:src="@{/images/{url}(url=${dto.profileImage})}">
            </div>
            <div class="col">
                <h2 class="fw-normal" th:text="|${dto.username}' Page|">Heading</h2>
                <p th:text="|${dto.nickname}(${dto.email})|"></p>
                <br th:if="${dto.bio == null}"/>
                <p th:unless="${dto.bio == null}" th:text="${dto.bio}"> </p>
                <p th:if="${dto.owner}"><button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#updateUserModal">Update Profile Â»</button></p>
            </div>
        </div>
        <div class="modal fade" id="updateUserModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel" th:text="${dto.username}">Modal title</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form class="needs-validation"
                              id="profileUpdateForm"
                              novalidate=""
                              th:action="@{/user/{userId}(userId=${dto.userId})}"
                              th:method="put"
                              enctype="multipart/form-data">

                            <input type="text"
                                   class="form-control" style="display:none;"
                                   id="userId" name="userId" th:value="${dto.userId}">

                            <img
                                 id="imageUploadPreview"
                                 class="bd-placeholder-img rounded-circle m-3"
                                 width="180" height="180"
                                 th:src="@{/images/{url}(url=${dto.profileImage})}"
                                 errors="/img/white.png"
                            >

                            <div class="input-group mb-3">
                                <label class="input-group-text" for="profileImage">Profile Image</label>
                                <input type="file" class="form-control"
                                       id="profileImage" name="profileImage" onchange="imageChoose(this)">
                            </div>

                            <div class="input-group mb-3">
                                <span class="input-group-text" for="nickname">Nickname</span>
                                <input type="text" class="form-control" id="nickname" name="nickname"
                                       th:value="${dto.nickname}"
                                       aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
                            </div>

                            <div class="input-group mb-3">
                                <span class="input-group-text" for="email">E-mail</span>
                                <input type="text" class="form-control" id="email" name="email"
                                       th:value="${dto.email}"
                                       aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
                            </div>

                            <div class="input-group mb-3">
                                <span class="input-group-text" for="bio">Bio</span>
                                <input type="text" class="form-control" id="bio" name="bio"
                                       th:value="${dto.bio}"
                                       aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
                            </div>

                            <div class="modal-footer d-flex">
                                <button class="btn btn-primary">Save</button>
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            </div>
                        </form>

                    </div>

                </div>
            </div>
        </div>

    </section>
    <div class="album py-5 bg-body-tertiary">
        <div class="container">
            <p class="m-3" th:text="|${dto.musicCount} musics|"></p>
            <div th:if="${dto.musicList.size() != 0}" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                <!-- CARD -->
                <div class="col" th:each="music : ${dto.musicList}">
                    <div th:replace="/fragment/card :: card(${music})"></div>
                </div>
            </div>
            <div th:unless="${dto.musicList.size() != 0}" class="col-lg-6 col-md-8 mx-auto">
                <h1 class="fw-light" >No Musics</h1>
            </div>
        </div>
    </div>
</main>

<script src="/js/profile.js"></script>
<script src="/js/modals.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>

</body>
</html>
